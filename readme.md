This is a new, abstracted version.
